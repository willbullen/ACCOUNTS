{% extends 'django_ledger/layouts/base_shadcn.html' %}
{% load static %}

{% block content %}
<div class="min-h-screen bg-[#0a0a0a] text-white">
    <!-- Header -->
    <div class="px-8 py-6 border-b border-gray-800">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold">Bank Accounts</h1>
                <p class="text-gray-400 mt-1">Manage and track all your bank accounts</p>
            </div>
            <a href="{% url 'bank-account-create-shadcn' entity_slug=view.kwargs.entity_slug %}"
               class="px-4 py-2 bg-indigo-900/50 hover:bg-indigo-800/50 border border-indigo-700 rounded text-indigo-300 transition-colors flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
                New Bank Account
            </a>
        </div>
    </div>

    <!-- Content -->
    <div class="px-8 py-6">
        <!-- Search and Filter Bar -->
        <div class="mb-6 flex items-center gap-4">
            <div class="flex-1 relative">
                <svg class="absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                </svg>
                <input type="text" 
                       id="search-input"
                       placeholder="Search bank accounts..." 
                       class="w-full pl-10 pr-4 py-2 bg-[#1a1a1a] border border-gray-800 rounded text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
            </div>
        </div>

        <!-- Bank Account List Section -->
        <div class="bg-[#1a1a1a] border border-gray-800 rounded-lg">
            <div class="p-6 border-b border-gray-800">
                <h2 class="text-xl font-semibold">Bank Account List</h2>
            </div>
            
            <!-- Table -->
            <div class="overflow-x-auto">
                <table class="w-full" id="bank-accounts-table">
                    <thead class="bg-[#0f0f0f] border-b border-gray-800">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Account Name</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Account Number</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Account Type</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Routing Number</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-800">
                        {% for bank_account in bank_accounts %}
                        <tr class="hover:bg-[#0f0f0f] transition-colors search-row">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center gap-3">
                                    <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-500 to-indigo-600 flex items-center justify-center flex-shrink-0">
                                        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                        </svg>
                                    </div>
                                    <div>
                                        <div class="text-white font-medium search-text">{{ bank_account.name }}</div>
                                        {% if bank_account.cash_account %}
                                        <div class="text-sm text-gray-400">{{ bank_account.cash_account.name }}</div>
                                        {% endif %}
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-gray-300 font-mono search-text">{{ bank_account.account_number|default:"—" }}</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 py-1 rounded text-xs font-medium bg-indigo-900/30 text-indigo-300 border border-indigo-700/50 search-text">
                                    {{ bank_account.get_account_type_display|default:bank_account.account_type|title }}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-gray-300 font-mono search-text">{{ bank_account.routing_number|default:"—" }}</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                {% if bank_account.active %}
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-green-900/30 text-green-300 border border-green-700/50">
                                        <svg class="w-3 h-3 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                        </svg>
                                        Active
                                    </span>
                                {% else %}
                                    <span class="px-2 py-1 rounded text-xs font-medium bg-gray-800 text-gray-400 border border-gray-700">
                                        Inactive
                                    </span>
                                {% endif %}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center gap-2">
                                    <a href="{% url 'bank-account-detail-shadcn' entity_slug=view.kwargs.entity_slug bank_account_pk=bank_account.uuid %}"
                                       class="px-3 py-1 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded text-gray-300 text-sm transition-colors">
                                        View
                                    </a>
                                    <a href="{% url 'bank-account-update-shadcn' entity_slug=view.kwargs.entity_slug bank_account_pk=bank_account.uuid %}"
                                       class="px-3 py-1 bg-indigo-900/50 hover:bg-indigo-800/50 border border-indigo-700 rounded text-indigo-300 text-sm transition-colors">
                                        Edit
                                    </a>
                                </div>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="6" class="px-6 py-12 text-center">
                                <div class="flex flex-col items-center justify-center">
                                    <svg class="w-16 h-16 text-gray-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                                    </svg>
                                    <p class="text-gray-400 text-lg mb-2">No bank accounts found</p>
                                    <p class="text-gray-500 text-sm mb-4">Get started by adding your first bank account</p>
                                    <a href="{% url 'bank-account-create-shadcn' entity_slug=view.kwargs.entity_slug %}"
                                       class="px-4 py-2 bg-indigo-900/50 hover:bg-indigo-800/50 border border-indigo-700 rounded text-indigo-300 transition-colors">
                                        Add your first bank account
                                    </a>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="{% static 'js/table-search.js' %}"></script>
{% endblock %}
